---
title: "Data Analysis"
author: "Vincent Morin"
date: "12/2/2019"
output: html_document
---

- Purpose of my methodology -- why did I choose this as a goal -- based on course objectives:

1. Receive exposure to the main concepts associated with data science.

2. Learn how to wrangle (prepare and clean) different types of data.

3. Learn to analyze data for descriptive and predictive purposes.

4. Understand the basics of programming in R with emphasis on the “tidy” ecosystem of packages.

5. Learn to identify and visualize important trends and findings.

6. Debate and articulate ideas related to data.

7. Tell a coherent, meaningful data science story.

- Am I doing this correctly
- Presentation -- why did I choose this data, what is my progress looking like, change in proposal, background on data. 

- Projected models -- supervised machine learning - linear, knn, random forest.


- thoughts, changes, comments, concerns?
- logical type variable -- convert before applying dummy, or via dummy. 
- Size issue with dataset -- best practices -- zip files? documentation for locating?










```{r setup, include=FALSE}
knitr::opts_chunk$set(message = F,error=F,comment = F)
require(tidyverse)
require(tidytext)
require(lubridate)
require(ggthemes)
require(textdata)
require(topicmodels)
require(recipes)
require(caret)
```

```{r}
# Import Dataset
Data = read_csv("Data/2016_Green_Weather_Data.csv") 

```




Calculate time per trip in seconds, add as new variable. 




Add new variables

```{r}

Data$Pickup_hour <- 
  hour(GreenData$lpep_pickup_datetime)




Data$Pickup_day <- 
  day(GreenData$lpep_pickup_datetime)




Data$Pickup_week <-
  hour(GreenData$lpep_pickup_datetime)




Data %>% glimpse()
```

```{r}
Data2 <- Data %>% mutate(
  date = as.Date(Data$lpep_pickup_datetime)) %>%
  select(., -lpep_pickup_datetime, -Lpep_dropoff_datetime)

Data2 %>% glimpse()
```

```{r}
Data2$has_snow <- as.numeric(Data2$has_snow)

Data2$has_rain <- as.numeric(Data2$has_rain)

Data2 %>% glimpse()
```




Split the data

```{r}
set.seed(333) 

index = createDataPartition(Data2$Tip_amount, p=.75,list=F) 

train_data = Data2[index,] # Use 75% of the data as training data 

test_data = Data2[-index,] # holdout 25% as test data

```

```{r}
round(nrow(train_data)/nrow(Data),3)
```




```{r}
plot1 <- train_data %>%
  group_by(date) %>%
  summarise(Tip = mean(Tip_amount)) %>%
  ggplot(aes(date, Tip, color = date)) +
  geom_jitter(show.legend = F)


plot1
```

```{r}
plot2 = train_data %>%
  group_by(date, has_rain) %>%
  summarise(Tip = mean(Tip_amount)) %>%
  ggplot(aes(date, Tip, color = has_rain)) +
  geom_jitter(show.legend = T)



plot2

```


```{r}
plot3 = train_data %>%
  group_by(date, precipitation) %>%
  summarise(Tip = mean(Tip_amount)) %>%
  ggplot(aes(date, Tip, color = precipitation)) +
  geom_jitter(show.legend = T)



plot3
```

```{r}
train_data %>% 
  summarize_all(class) %>% 
  glimpse()
```



```{r}
train_data %>% 
  summarize_if(is.numeric, function(x) mean(x)) %>%
  glimpse()
```

```{r}
train_data %>% 
  select_if(is.factor) %>% 
  glimpse()
```


---
title: "Cleaning New York Data"
author: "Vincent Morin"
date: "12/2/2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(message = F,error=F,comment = F)
require(tidyverse)
require(tidytext)
require(lubridate)
require(ggthemes)
require(textdata)
require(topicmodels)
require(recipes)
require(caret)
```

This file is to handle the initial cleaning of the 2016 Green Taxi dataset.  This data is far too large to cooperate with the average system, and therefore will require considerable scaling, while keeping consideration to the purpose of the project analysis. 

```{r}
# Import Dataset
GreenTdata = read_csv("Data/2016_Green_Taxi_Trip_Data.csv") 
```

Because this is such a large dataset, we'll consider extranneous high-level material to remove.  Removal criteria include: uncertainty/unknown descriptor, constant value, and location.  Sensitive to the constraint of the project, we will consider all trips to endure the weather recorded out of the Central Park weather station, and therefore remove columns related to location.   

**Trimming** 

We'll begin by removing several columns which have constant values, unknown descriptors, or are otherwise irrelevant to the analysis.  Some columns which were removed include pickup and dropoff locations

These include:
- VendorID
- Store_and_fwd_flag
- RateCodeID
- Pickup_longitude
- Pickup_latitude
- Dropoff_longitutde
- Dropoff_latitude
- Ehail_fee
- Trip_type
- Payment_type
- PULocationID
- DOLocationID


```{r}
# Remove several variables not relevant to goal. 
GreenTdata2 <- select(GreenTdata, -VendorID, -Store_and_fwd_flag, 
                      -RateCodeID, -Pickup_longitude, -Pickup_latitude, 
                      -Dropoff_longitude, -Dropoff_latitude, -Ehail_fee, 
                      -Trip_type, -Payment_type, -PULocationID, 
                      -DOLocationID)

```

Because we want our focus to be an analysis on riders who tippied, and due to the constraint of size and time, we will filter out all rows without tips. 

```{r}
# filter out rows where observation in variable Tip_amount
# is equal to 0
GreenTips <- GreenTdata2[GreenTdata2$Tip_amount != 0, ]

```


**Clean Data**

Change column type for dates from character to date type; this will be useful in further analysis. 

```{r}
GreenTips$lpep_pickup_datetime <- mdy_hms(GreenTips$lpep_pickup_datetime)



GreenTips$Lpep_dropoff_datetime <- mdy_hms(
  GreenTips$Lpep_dropoff_datetime)



head(GreenTips)
```

Reduce overall size of dataset: only keep data from first half of the year. 


```{r}
GreenData <- GreenTips %>% mutate(
  date = as.Date(GreenTips$lpep_pickup_datetime))




GreenData <- GreenDate %>% filter(
  GreenDate$date < "2016-7-1")




#GreenJanJun <- subset(GreenTips,  lpep_pickup_datetime > as.Date("2016-07-01"))

head(GreenData)
tail(GreenData)
```

Drop created date variable.

```{r}
GreenData <- GreenData %>% select(-date)
```

Save new data to Data/ folder. 

```{r}
# Save new datafile

GreenData %>% write_csv(path = "Data/2016_Green_Taxi_Data.csv")

```




